<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script type="text/javascript" src="dist/resources/argoproj.io/AnalysisRun/ui/extensions.js"></script>
    <title>Demo AnalysisRun Extension</title>
</head>

<body>
    <div id="root"></div>
    <script>
        var resource = {
  "apiVersion": "argoproj.io/v1alpha1",
  "kind": "AnalysisRun",
  "metadata": {
    "annotations": {
      "rollout.argoproj.io/revision": "336"
    },
    "creationTimestamp": "2023-08-30T20:22:20Z",
    "generation": 13,
    "labels": {
      "rollout-type": "Background",
      "rollouts-pod-template-hash": "7b457c5d5d"
    },
    "name": "web-7b457c5d5d-336.4",
    "namespace": "default",
    "ownerReferences": [
      {
        "apiVersion": "argoproj.io/v1alpha1",
        "blockOwnerDeletion": true,
        "controller": true,
        "kind": "Rollout",
        "name": "web",
        "uid": "bf639550-fb22-493a-9c16-d9633a7ea77b"
      }
    ],
    "resourceVersion": "227185360",
    "uid": "2c703cf5-d9a4-4163-be01-2da672cdd7d7"
  },
  "spec": {
    "args": [
      {
        "name": "stablehash",
        "value": "c5f6f8656"
      },
      {
        "name": "latesthash",
        "value": "7b457c5d5d"
      }
    ],
    "metrics": [
      {
        "failureLimit": 5,
        "interval": "1m",
        "name": "cpu",
        "provider": {
          "datadog": {
            "query": "clamp_min(sum:kubernetes.cpu.usage.total{rollouts-pod-template-hash:{{args.latesthash}}}, 1000000000) /\nclamp_min(sum:kubernetes.cpu.usage.total{rollouts-pod-template-hash:{{args.stablehash}}}, 1000000000)\n"
          }
        },
        "successCondition": "default(result, 0) <= 1.1"
      },
      {
        "failureLimit": 5,
        "interval": "1m",
        "name": "error-rate",
        "provider": {
          "datadog": {
            "query": "(sum:it.service.hits{rollouts-pod-template-hash:{{args.latest-hash}}} /\nsum:it.service.errors{rollouts-pod-template-hash:{{args.latest-hash}}}) /\n(sum:it.service.hits{rollouts-pod-template-hash:{{args.stable-hash}}} /\nsum:it.service.errors{rollouts-pod-template-hash:{{args.stable-hash}}})\n"
          }
        },
        "successCondition": "default(result, 0) <= 1.1"
      },
      {
        "failureLimit": 5,
        "interval": "1m",
        "name": "latency",
        "provider": {
          "datadog": {
            "query": "clamp_min(p90:it.service.duration{rollouts-pod-template-hash:{{args.latest-hash}}}, 20000000) /\nclamp_min(p90:it.service.duration{rollouts-pod-template-hash:{{args.stable-hash}}}, 20000000)\n"
          }
        },
        "successCondition": "default(result, 0) <= 1.1"
      },
      {
        "failureLimit": 5,
        "interval": "1m",
        "name": "memory",
        "provider": {
          "datadog": {
            "query": "avg:kubernetes.memory.usage_pct{rollouts-pod-template-hash:{{args.latest-hash}}} /\navg:kubernetes.memory.usage_pct{rollouts-pod-template-hash:{{args.stable-hash}}}\n"
          }
        },
        "successCondition": "default(result, 0) <= 1.1"
      }
    ]
    },
    "status": {
    "dryRunSummary": {},
    "metricResults": [
      {
        "count": 12,
        "measurements": [
          {
            "finishedAt": "2023-08-30T20:24:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:24:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:25:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:25:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:26:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:26:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:27:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:27:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:28:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:28:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:29:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:29:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:30:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:30:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:31:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:31:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:32:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:32:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:33:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:33:21Z",
            "value": "1"
          }
        ],
        "name": "cpu",
        "phase": "Running",
        "successful": 12
      },
      {
        "count": 12,
        "measurements": [
          {
            "finishedAt": "2023-08-30T20:24:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:24:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:25:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:25:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:26:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:26:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:27:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:27:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:28:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:28:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:29:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:29:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:30:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:30:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:31:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:31:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:32:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:32:21Z",
            "value": "0"
          },
          {
            "finishedAt": "2023-08-30T20:33:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:33:21Z",
            "value": "0"
          }
        ],
        "name": "error-rate",
        "phase": "Running",
        "successful": 12
      },
      {
        "count": 12,
        "measurements": [
          {
            "finishedAt": "2023-08-30T20:24:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:24:21Z",
            "value": "0.13388024455473904"
          },
          {
            "finishedAt": "2023-08-30T20:25:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:25:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:26:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:26:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:27:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:27:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:28:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:28:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:29:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:29:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:30:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:30:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:31:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:31:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:32:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:32:21Z",
            "value": "1"
          },
          {
            "finishedAt": "2023-08-30T20:33:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:33:21Z",
            "value": "1"
          }
        ],
        "name": "latency",
        "phase": "Running",
        "successful": 12
      },
      {
        "count": 12,
        "failed": 1,
        "measurements": [
          {
            "finishedAt": "2023-08-30T20:24:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:24:21Z",
            "value": "0.7699534502779091"
          },
          {
            "finishedAt": "2023-08-30T20:25:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:25:21Z",
            "value": "0.8101034722925345"
          },
          {
            "finishedAt": "2023-08-30T20:26:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:26:21Z",
            "value": "0.8000529689421993"
          },
          {
            "finishedAt": "2023-08-30T20:27:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:27:21Z",
            "value": "0.7467400222328734"
          },
          {
            "finishedAt": "2023-08-30T20:28:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:28:21Z",
            "value": "1.0459187234489544"
          },
          {
            "finishedAt": "2023-08-30T20:29:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:29:21Z",
            "value": "1.036604527178857"
          },
          {
            "finishedAt": "2023-08-30T20:30:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:30:21Z",
            "value": "1.0087104444802624"
          },
          {
            "finishedAt": "2023-08-30T20:31:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:31:21Z",
            "value": "1.0901854878092372"
          },
          {
            "finishedAt": "2023-08-30T20:32:21Z",
            "phase": "Failed",
            "startedAt": "2023-08-30T20:32:21Z",
            "value": "1.1060305741797762"
          },
          {
            "finishedAt": "2023-08-30T20:33:21Z",
            "phase": "Successful",
            "startedAt": "2023-08-30T20:33:21Z",
            "value": "1.0919431788459897"
          }
        ],
        "name": "memory",
        "phase": "Running",
        "successful": 11
      }
    ],
    "phase": "Running",
    "runSummary": {
      "count": 4
    },
    "startedAt": "2023-08-30T20:22:21Z"
  }
};

        ReactDOM.render(window.extensions.resources["argoproj.io/AnalysisRun"].component({ tree: {}, resource: resource }), document.getElementById("root"))
    </script>
</body>

</html>